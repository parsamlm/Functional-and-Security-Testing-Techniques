<h1>Vulnerability Scanner</h1>
<h2>Introduction</h2>
<p>This script is written to scan the services that are running on any WordPress website and Docker networks. It will check the services for vulnerabilities and provide a report. The script is written in Kotlin.</p>
<p>The script gives user two options:</p>
<ol>
    <li><b>Manual:</b> Get services input file from user.</li>
    <li><b>Docker:</b> Scan Docker networks for existing services.</li>
</ol>
<p><b>Caution: Do not use this script for unethical and illegal purposes.</b></p>
<p>This project leverages <a href="https://github.com/parsamlm/VulnerabilityFinder">VulnerabilityFinder</a> to retrieve potential vulnerabilities affecting the services from the National Vulnerability Database (NVD) API. To maximize the number of permissible requests and ensure optimal performance, it is highly recommended to <a href="https://nvd.nist.gov/developers/request-an-api-key">request a free NVD API key</a>.</p>
<p>Following the successful retrieval of your API key, proceed to copy and paste it into the designated file, 'src/main/resources/nvd_api.json'. For your reference, an illustrative example is provided below:</p>

```json
{
  "apiKey": "[ENTER YOUR API KEY]"
}
```

<h2>Getting Started</h2>
<ol>
<li style="font-size: 1.2em">
    <b>Manual Option</b>
</li>
</ol>
<ul>
<p><b>Requirements:</b></p>
<p>This option has no specific prerequisites.</p>
<p><b>Note: </b> Before running the script, make sure you have created an input file following the guidelines outlined in the next section.</p>
<p><b>Input:</b></p>
<p>This option requires the creation of an input file in the <b>JSON format</b>. This file can specify various services you wish to analyze.  The input file should be placed within the project's dedicated <b>"resources"</b> directory. The JSON file structure should adhere to the following attributes:</p>

<ol>
    <li><b>Mandatory Attributes</b> that are needed to be declared in the file:
        <ol>
            <li><b>url:</b> the <b>WordPress</b> website domain.</li>
            <li><b>type:</b> <b>WordPress</b>, <b>Apache</b> (Web Server), or <b>MySQL</b></li>
        </ol>
    </li>
<br>
    <li><b>Optional Attributes</b> that can be declared in the file:
        <ol>
            <li>ipAddress: the IP Address of the WordPress website domain.</li>
            <li>ports: it might have several ports, so it should be declared as an array.</li>
            <li>vendor: the service vendor.</li>
            <li>version: if it is not declared by the file, the script will find the version of the service itself.</li>
        </ol>
    </li>
</ol>
<p>Example of required to be input file:</p>

```json
[
  {
    "ipAddress": "127.0.0.1",
    "url": "http://localhost/[your_website_name]/",
    "ports": [
      "80/tcp"
    ],
    "vendor": "wordpress",
    "type": "wordpress",
    "version": "6.5.2"
  }
]
```

<p><b>Output:</b></p>
<p>The tool generates two outputs:</p>
<ol>
<li><b>Updated JSON File: </b>The original input JSON file will be modified to include information about the identified vulnerabilities.</li>
<li><b>Service Details PDF Report (output.pdf): </b>A PDF report will be generated containing details about the discovered vulnerabilities for each service. This report includes a table for each service, with the following characteristics</li>
<uL>
<li>
<b>Columns:</b>
<ul><li><b>CVE ID: </b>This column lists the identifier for each Common Vulnerabilities and Exposures (CVE) associated with the service.</li></ul>
<ul><li><b>Description: </b>This column provides a brief explanation of the vulnerability.</li></ul>
<ul><li><b>Severity: </b>This column indicates the severity level of the vulnerability.</li></ul>
</li>
<li>
<b>Color Coding: </b>The background color of each row in the tables will be assigned a priority level based on the severity rating:
<ul>
<li><b>High Severity: </b>Red</li>
<li><b>Medium Severity: </b>Yellow</li>
<li><b>Low Severity: </b>Blue</li>
</ul>
</li>
<li>
<b>Sorting: </b>The vulnerabilities within each table will be sorted by severity level, with high severity vulnerabilities listed first.
</li>
</uL>
</ol>
</ul>

<ol start="2">
<li style="font-size: 1.2em">
    <b>Docker Option</b>
</li>
</ol>
<ul>
<p><b>Requirements:</b></p>
<ol>
    <li>To start working with this option, you need to install <a href="https://www.docker.com/products/docker-desktop/">Docker Desktop</a>. After installation, run the installed application in order to Docker Daemon will be started, otherwise you cannot use the script.</li>
    <li>It is needed to create a Docker network and make at least one service in the created network to test the script functionality.
<ul><li> Optionally, you can use the <b>docker-compose.yml</b> file which will automatically create a network ("my-network") and three services as its containers (WordPress, Apache web server, and MySQL). To use this option. you have to proceed to the "wordpress-docker" directory, and then run the below command in terminal:<ul><li><code>docker-compose up -d</code></li><li>
    <b>-d: </b>it will run the command in detached mode.
    <br>
</li></ul></li></ul>
</li>
</ol>
<p><b>Input:</b></p>
<p>The script will automatically scan different available networks on the Docker, then asks user a network name, and scan the given network. So, there is no need to enter any further service details in order to proceed with this option.</p>
<p><b>Output:</b></p>
<p>The tool generates an output file:</p>
<ol>
<li><b>Service Details PDF Report (output.pdf): </b>A PDF report will be generated containing details about the discovered vulnerabilities for each service. This report includes a table for each service, with the following characteristics</li>
<uL>
<li>
<b>Columns:</b>
<ul><li><b>CVE ID: </b>This column lists the identifier for each Common Vulnerabilities and Exposures (CVE) associated with the service.</li></ul>
<ul><li><b>Description: </b>This column provides a brief explanation of the vulnerability.</li></ul>
<ul><li><b>Severity: </b>This column indicates the severity level of the vulnerability.</li></ul>
</li>
<li>
<b>Color Coding: </b>The background color of each row in the tables will be assigned a priority level based on the severity rating:
<ul>
<li><b>High Severity: </b>Red</li>
<li><b>Medium Severity: </b>Yellow</li>
<li><b>Low Severity: </b>Blue</li>
</ul>
</li>
<li>
<b>Sorting: </b>The vulnerabilities within each table will be sorted by severity level, with high severity vulnerabilities listed first.
</li>
</uL>
</ol>
</ul>