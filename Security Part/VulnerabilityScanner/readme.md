<h1>Vulnerability Scanner</h1>
<h2>Introduction</h2>
<p>This script is written to scan the services that are running on any WordPress website and Docker networks. It will check the services for vulnerabilities and provide a report. The script is written in Kotlin.</p>
<p>The script gives user two options:</p>
<ol>
    <li><b>Manual:</b> Get services input file from user.</li>
    <li><b>Docker:</b> Scan Docker networks for existing services.</li>
</ol>
<p><b>Caution: Do not use this script for unethical and illegal purposes.</b></p>
<p>This project leverages <a href="https://github.com/parsamlm/VulnerabilityFinder">VulnerabilityFinder</a> to retrieve potential vulnerabilities affecting the services from the National Vulnerability Database (NVD) API. To maximize the number of permissible requests and ensure optimal performance, it is highly recommended to <a href="https://nvd.nist.gov/developers/request-an-api-key">request a free NVD API key</a>.</p>
<p>Following the successful retrieval of your API key, proceed to copy and paste it into the designated file, 'src/main/resources/nvd_api.json'. For your reference, an illustrative example is provided below:</p>

```json
{
  "apiKey": "[ENTER YOUR API KEY]"
}
```

<h3>Supported Services</h3>
<p>This script only supports <b>WordPress</b>, <b>Apache Web Server</b>, <b>MySQL</b>, and <b>MongoDB</b>.</p>
<h2>Getting Started</h2>
<ol>
<li style="font-size: 1.2em">
    <b>Manual Option</b>
</li>
</ol>
<ul>
<p><b>Requirements:</b></p>
<ul>
<li>This option needs an input file (which should be JSON file) to be placed in the <b>"resources"</b> directory. So, make sure you have created one regarding the following guidelines outlined in the next section.</li>
<li>It is needed to use the services which are available on the local system.</li>
</ul>
<p><b>Input:</b></p>
<p>This option requires the creation of an input file in the <b>JSON format</b>. This file can specify various services you wish to analyze.  The input file should be placed within the project's dedicated <b>"resources"</b> directory. The JSON file structure should adhere to the following attributes:</p>

<ol>
    <li><b>Mandatory Attributes</b> that are needed to be declared in the file:
        <ol>
            <li><b>url:</b> the <b>WordPress</b> website domain.</li>
            <li><b>type:</b> <b>wordpress</b>, <b>apache</b> (Web Server), <b>mysql</b>, or <b>mongodb</b>.</li>
        </ol>
    </li>
<br>
    <li><b>Optional Attributes</b> that can be declared in the file:
        <ol>
            <li>ipAddress: the IP Address of the WordPress website domain.</li>
            <li>ports: it might have several ports, so it should be declared as an array.</li>
            <li>vendor: the service vendor.</li>
            <li>version: if it is not declared by the file, the script will find the version of the service itself.</li>
        </ol>
    </li>
</ol>
<p>An example of the input file:</p>

```json
[
  {
    "ipAddress": "127.0.0.1",
    "url": "http://localhost/[YOUR_WEBSITE_NAME]/",
    "ports": [
      "80/tcp"
    ],
    "vendor": "wordpress",
    "type": "wordpress"
  },
  {
    "ipAddress": "127.0.0.1",
    "url": "http://localhost/",
    "ports": [
      "3306/tcp"
    ],
    "vendor": "mysql",
    "type": "mysql"
  },
  {
    "ipAddress": "127.0.0.1",
    "url": "http://localhost/",
    "ports": [
      "80/tcp"
    ],
    "vendor": "httpd",
    "type": "apache"
  }
]
```

<p><b>Test:</b></p>
<p>For testing purposes, you can use the provided <b>input.json</b> file located in the <b>"resources"</b> directory. This file contains a sample service entry for a WordPress website. To execute the script, simply run <b>"Main.kt"</b> script and enter the <b>"input.json"</b> as the file name, when the script asks you.</p>
<p>This script assumes you have already created the required services (WordPress, MySQL, and Apache Web Server) using a tool like Xampp.</p>
<p>If it is needed, modify the input.json file to make sure the script will work properly.</p>

<p><b>Output:</b></p>
<p>The tool generates two outputs:</p>
<ol>
<li><b>Updated JSON File: </b>The original input JSON file will be modified to include information about the identified vulnerabilities.</li>
<li><b>Service Details PDF Report (output.pdf): </b>A PDF report will be generated containing details about the discovered vulnerabilities for each service. This report includes a table for each service, with the following characteristics</li>
<uL>
<li>
<b>Columns:</b>
<ul><li><b>CVE ID: </b>This column lists the identifier for each Common Vulnerabilities and Exposures (CVE) associated with the service.</li></ul>
<ul><li><b>Description: </b>This column provides a brief explanation of the vulnerability.</li></ul>
<ul><li><b>Severity: </b>This column indicates the severity level of the vulnerability.</li></ul>
</li>
<li>
<b>Color Coding: </b>The background color of each row in the tables will be assigned a priority level based on the severity rating:
<ul>
<li><b>High Severity: </b>Red</li>
<li><b>Medium Severity: </b>Orange</li>
<li><b>Low Severity: </b>Yellow</li>
</ul>
</li>
<li>
<b>Sorting: </b>The vulnerabilities within each table will be sorted by severity level, with high severity vulnerabilities listed first.
</li>
</uL>
</ol>
</ul>

<ol start="2">
<li style="font-size: 1.2em">
    <b>Docker Option</b>
</li>
</ol>
<ul>
<p><b>Requirements:</b></p>
<ol>
    <li>To start working with this option, you need to install <a href="https://www.docker.com/products/docker-desktop/">Docker Desktop</a>. After installation, run the installed application in order to Docker Daemon will be started, otherwise you cannot use the script.</li>
    <li>It is needed to create a Docker network and make at least one service in the created network to test the script functionality.
    <li>If you have WordPress container in your docker network, make sure to install WordPress, before using the script. otherwise the script cannot find the WordPress version as the website is not shown.</li>
</ol>
<p><b>Input:</b></p>
<p>The script will automatically scan different available networks on the Docker, then asks user a network name, and scan the given network to find its services. So, there is no need to enter any further service details in order to proceed with this option.</p>

<p><b>Test:</b></p>
Optionally, you can use the <b>docker-compose.yml</b> file which is included in the "services" directory. It automatically creates a network ("my-network") and four services as its containers (WordPress, Apache web server, MySQL, and MongoDB) which can be tested using this script. To use this option. you have to proceed to the mentioned directory, and then run the below command in terminal:<ul><li><code>docker-compose up -d</code></li><li>
    <b>-d: </b>it will run the command in detached mode.
    <br>
</li></ul>

<p><b>Output:</b></p>
<p>The tool generates an output file:</p>
<ol>
<li><b>JSON File (network_services.json):</b> Upon successful execution, the script generates a JSON file containing detailed information about the selected network services within your Docker network. This data includes service type, vendor, associated vulnerabilities (if any), and potentially other relevant details.</li>
<li><b>Service Details PDF Report (output.pdf): </b>A PDF report will be generated containing details about the discovered vulnerabilities for each service. This report includes a table for each service, with the following characteristics</li>
<uL>
<li>
<b>Columns:</b>
<ul><li><b>CVE ID: </b>This column lists the identifier for each Common Vulnerabilities and Exposures (CVE) associated with the service.</li></ul>
<ul><li><b>Description: </b>This column provides a brief explanation of the vulnerability.</li></ul>
<ul><li><b>Severity: </b>This column indicates the severity level of the vulnerability.</li></ul>
</li>
<li>
<b>Color Coding: </b>The background color of each row in the tables will be assigned a priority level based on the severity rating:
<ul>
<li><b>High Severity: </b>Red</li>
<li><b>Medium Severity: </b>Orange</li>
<li><b>Low Severity: </b>Yellow</li>
</ul>
</li>
<li>
<b>Sorting: </b>The vulnerabilities within each table will be sorted by severity level, with high severity vulnerabilities listed first.
</li>
</uL>
</ol>
</ul>

<h2>Responsible Use</h2>
<p>This software should not be used for illegal or unethical activities. Any actions and or activities related to the material contained within this software is solely your responsibility. Misuse of the information in this software can result in criminal charges brought against the persons in question.  <br>Please ensure that your use of this software complies with all applicable local, state, and federal laws and regulations.</p>

<h2>Disclaimer</h2>
<p>This project is intended for educational and research purposes only. The use of this software is your responsibility and its authors or contributors are not liable for how it is used.  <br>The software is provided "as is", without warranty of any kind, express or implied, including but not limited to the warranties of merchantability, fitness for a particular purpose and noninfringement. In no event shall the authors or copyright holders be liable for any claim, damages or other liability, whether in an action of contract, tort or otherwise, arising from, out of or in connection with the software or the use or other dealings in the software.</p>