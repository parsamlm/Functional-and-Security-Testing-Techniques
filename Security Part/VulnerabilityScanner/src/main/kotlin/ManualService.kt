import org.jsoup.Jsoup

fun getRequiredDataFromUser(): Map<String, String> {
    val ipAddress = getUserInput("Enter service IP Address:")
    val url = getUserInput("Enter service domain:")
    val ports = getUserInput("Enter service Ports (divide them by a single space):")
    val serviceType = getUserInput("Enter service Type:")
    return mapOf("ipAddress" to ipAddress, "url" to url, "ports" to ports, "serviceType" to serviceType)
}


fun getWebsiteContent(url: String): String {
    var htmlDocument = ""
    try {
        htmlDocument = HttpRequestExecutor().run(
            url = url,
        )
    } catch (exception: Exception) {
        return htmlDocument
    }
    return htmlDocument
}

fun getWordPressVersion(url: String?): Map<String, String?> {
    if(url != null){
        val htmlDocument = getWebsiteContent(url)
        if (htmlDocument.isNotEmpty()) {
            val doc = Jsoup.parse(htmlDocument)
            val metaTag = doc.select("meta[name=generator]").first()
            if (metaTag != null) {
                val content = metaTag.attr("content")
                if (content.contains("WordPress")) {
                    return mapOf("version" to content.split(" ")[1])
                }
            }
        }
    }
    return mapOf("version" to null)
}